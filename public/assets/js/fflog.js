// Generated by CoffeeScript 1.6.2
(function() {
  var DELIMITER, setInputFocus, showSection, validateInputs;

  DELIMITER = '|<>|';

  showSection = function(target) {
    $('.js-show-section').each(function() {
      return $(this).removeClass('active');
    });
    target.addClass('active');
    if (target.hasClass('js-new-post-a')) {
      $('.js-blog-settings').fadeOut(400, function() {
        return $('.js-edit-posts').fadeOut(400, function() {
          return $('.js-new-post').fadeIn();
        });
      });
    }
    if (target.hasClass('js-blog-settings-a')) {
      $('.js-edit-posts').fadeOut(400, function() {
        return $('.js-new-post').fadeOut(400, function() {
          return $('.js-blog-settings').fadeIn();
        });
      });
    }
    if (target.hasClass('js-edit-posts-a')) {
      $('.js-new-post').fadeOut(400, function() {
        return $('.js-blog-settings').fadeOut(400, function() {
          return $('.js-edit-posts').fadeIn();
        });
      });
    }
  };

  setInputFocus = function(targetClass) {
    var initVal;

    $(targetClass).focus();
    initVal = $(targetClass).val();
    $(targetClass).val('');
    $(targetClass).val(initVal);
  };

  validateInputs = function(targetClass) {
    var invalid;

    invalid = false;
    $(targetClass).find('input[type=text], textarea').each(function() {
      if ($(this).hasClass('required') && $(this).val() === '') {
        return invalid = true;
      }
    });
    if (invalid === false) {
      targetClass.submit();
    } else {
      $('.js-error-message').html('Please complete all inputs').fadeIn();
      setTimeout(function() {
        return $('.js-error-message').fadeOut(500);
      }, 4000);
    }
  };

  $(function() {
    setTimeout(function() {
      return $('body').removeClass('invisible');
    }, 50);
    setTimeout(function() {
      $('.message').each(function() {
        if (!$(this).hasClass('no-remove')) {
          return $('.message').fadeOut(500, function() {
            return $('.message').remove();
          });
        }
      });
    }, 4000);
    $('textarea').css('overflow', 'hidden').autosize();
    setInputFocus('.js-focus-input');
    $('.js-validate-form').submit(function(e) {
      e.preventDefault();
      validateInputs(e.target);
    });
    $('.js-show-section').click(function(e) {
      showSection($(e.target));
      e.preventDefault();
    });
    $('.js-tags-input').keydown(function(e) {
      var val, valArray;

      if (e.keyCode === 13) {
        e.preventDefault();
        val = $('.js-tags').val();
        if (val !== '') {
          valArray = val.split(DELIMITER);
          valArray.push($(e.target).val());
          val = valArray.join(DELIMITER);
        } else {
          val = $(e.target).val();
        }
        $('.js-tags').val(val);
        $('.tag-holder').append('<div class="tag-name" data-tag="' + $(e.target).val() + '">' + $(e.target).val() + '<span class="js-tag-remove"> x</span></div>');
        $(e.target).val('');
      }
    });
    return $('body').on('click', '.js-tag-remove', function(e) {
      var valArray;

      $(e.target).parent().remove();
      valArray = [];
      $('.tag-name').each(function(e) {
        return valArray.push($(this).data('tag'));
      });
      return $('.js-tags').val(valArray.join(DELIMITER));
    });
  });

}).call(this);
